<!doctype html>
<html>
	<head>
		<meta content="IE=edge" http-equiv="X-UA-Compatible">
		<meta charset="utf-8">
		<meta content="width=device-width,initial-scale=1.0,minimum-scale=1.0,maximum-scale=1.0,user-scalable=no" name="viewport">
		<meta name="theme-color" content="#000000">

		<title>Mistify</title>

		<link rel="stylesheet" href="/stylesheets/fullscreen.css" type="text/css">

	</head>

	<body class="canvas canvas_mistify canvas_mistify_index">
		<canvas id='canvas'></canvas>

<script type="text/javascript">
'use strict'

var canvas = document.getElementById('canvas'),
	ctx = canvas.getContext('2d')

var ratio = window.devicePixelRatio
var width = window.innerWidth
var height = window.innerHeight

canvas.width = width * ratio
canvas.height = height * ratio
canvas.style.width =  width + "px"
canvas.style.height = height + "px"

ctx.scale(ratio, ratio)

window.onresize = function(event) {
	ratio = window.devicePixelRatio
	width = window.innerWidth
	height = window.innerHeight

	canvas.width = width * ratio
	canvas.height = height * ratio
	canvas.style.width =  width + "px"
	canvas.style.height = height + "px"
	
	ctx.scale(ratio, ratio)
}

var shapes = [],
	speed = 7

function Point() {
	this.x = parseInt(Math.random() * width)
	this.y = parseInt(Math.random() * height)
	this.xVel = parseInt(Math.random() * 2) == 1 ? 1 : -1
	this.yVel = parseInt(Math.random() * 2) == 1 ? 1 : -1
}

function Shape() {
	this.color = '#' + Math.floor(Math.random() * 16777215).toString(16)
	this.points = []

	for (var i = 0; i < 4; i++) {
		this.points.push(new Point())
	}

	this.draw = function() {
		ctx.strokeStyle = this.color
		ctx.beginPath()
		ctx.moveTo(this.points[0].x, this.points[0].y)

		for (var i = 1; i < this.points.length; i++) {
			var p = this.points[i]

			ctx.lineTo(p.x, p.y)
		}

		ctx.lineTo(this.points[0].x, this.points[0].y)
		ctx.closePath()
		ctx.stroke()
	}

	this.update = function() {
		for (var i = 0; i < this.points.length; i++) {
			var p = this.points[i]

			p.x += p.xVel * speed
			p.y += p.yVel * speed

			if (p.x > width) p.xVel = Math.abs(p.xVel) * -1
			if (p.x < 0) p.xVel = Math.abs(p.xVel)

			if (p.y > height) p.yVel = Math.abs(p.yVel) * -1
			if (p.y < 0) p.yVel = Math.abs(p.yVel)
		}
	}
}

var s = new Shape()
var s2 = new Shape()

function render() {
	ctx.fillStyle = 'rgba(0,0,0,0.1)'
	ctx.fillRect(0, 0, width, height)

	s.update()
	s.draw()

	s2.update()
	s2.draw()

	requestAnimationFrame(render)
}

render()
</script>

	</body>
</html>
